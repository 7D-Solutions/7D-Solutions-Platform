# Database
DATABASE_URL=postgres://auth_user:auth_pass@localhost:5433/auth_db
# PostgreSQL connection string.

# NATS
NATS_URL=nats://localhost:4222
# Event bus endpoint.

# Server
HOST=0.0.0.0
PORT=8080

# JWT (RS256)
JWT_PRIVATE_KEY_PEM="<example-private-key>"
JWT_PUBLIC_KEY_PEM="<example-public-key>"
JWT_KID=auth-key-1
# Use unique kid per key rotation.

# Token TTLs
ACCESS_TOKEN_TTL_MINUTES=15
REFRESH_TOKEN_TTL_DAYS=14

# Argon2
ARGON_MEMORY_KB=65536
ARGON_ITERATIONS=3
ARGON_PARALLELISM=1
# 64MB Ã— 50 concurrent = 3.2GB max.

# Concurrency Protection
MAX_CONCURRENT_HASHES=50
HASH_ACQUIRE_TIMEOUT_MS=5000

# Lockout
LOCKOUT_THRESHOLD=10
LOCKOUT_MINUTES=15

# Rate Limits
LOGIN_PER_MIN_PER_EMAIL=5
REGISTER_PER_MIN_PER_EMAIL=5
REFRESH_PER_MIN_PER_TOKEN=20

# Logging
RUST_LOG=info,auth_rs=debug

# Schema Validation
SCHEMA_DIR=/app/schemas
