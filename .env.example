# Database
DATABASE_URL=postgres://postgres:postgres@localhost:5432/auth_db

# NATS
NATS_URL=nats://localhost:4222

# Server
HOST=0.0.0.0
PORT=8080

# JWT (RS256) - Generate using OpenSSL commands in implementation guide
JWT_PRIVATE_KEY_PEM=-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----
JWT_PUBLIC_KEY_PEM=-----BEGIN PUBLIC KEY-----\n...\n-----END PUBLIC KEY-----
JWT_KID=auth-key-1

# TTLs
ACCESS_TOKEN_TTL_MINUTES=15
REFRESH_TOKEN_TTL_DAYS=14

# Argon2id params
ARGON_MEMORY_KB=65536
ARGON_ITERATIONS=3
ARGON_PARALLELISM=1

# Account lockout
LOCKOUT_THRESHOLD=10
LOCKOUT_MINUTES=15

# Rate limiting (keyed)
LOGIN_PER_MIN_PER_EMAIL=5
REGISTER_PER_MIN_PER_EMAIL=5
REFRESH_PER_MIN_PER_TOKEN=20

# Rate limiting (per-IP global)
IP_RL_PER_SECOND=10
IP_RL_BURST=20

# Hash concurrency limiting
MAX_CONCURRENT_HASHES=50
HASH_ACQUIRE_TIMEOUT_MS=5000

# Logging
RUST_LOG=info,auth_rs=debug
